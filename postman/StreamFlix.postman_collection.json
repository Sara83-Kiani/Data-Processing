{
  "info": {
    "_postman_id": "c3f8c2b3-7b8d-4f93-9a8e-6b0e2f7e3d5a",
    "name": "StreamFlix API - Lecturer Tests (15 endpoints)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "01 - Health (GET /)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Body is not empty', function () {",
              "  pm.expect(pm.response.text()).to.not.eql('');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "02 - Get Movies JSON (GET /content/movies)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/movies"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data is array', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('success', true);",
              "  pm.expect(json).to.have.property('data');",
              "  pm.expect(Array.isArray(json.data)).to.eql(true);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "03 - Get Movies XML (GET /content/movies with Accept: application/xml)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Accept",
            "value": "application/xml"
          }
        ],
        "url": "{{baseUrl}}/content/movies"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Content-Type is XML', function () {",
              "  const ct = pm.response.headers.get('Content-Type') || '';",
              "  pm.expect(ct.toLowerCase()).to.include('xml');",
              "});",
              "pm.test('Body looks like XML', function () {",
              "  const body = pm.response.text();",
              "  pm.expect(body).to.include('<response>');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "04 - Get Movie By ID (GET /content/movies/1)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/movies/1"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data has movieId', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.success).to.eql(true);",
              "  pm.expect(json.data).to.be.an('object');",
              "  pm.expect(json.data).to.have.property('movieId');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "05 - Get Series (GET /content/series)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/series"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data is array', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.success).to.eql(true);",
              "  pm.expect(Array.isArray(json.data)).to.eql(true);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "06 - Get Episodes By Series (GET /content/series/1/episodes?season=1)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/series/1/episodes?season=1"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data is array', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.success).to.eql(true);",
              "  pm.expect(Array.isArray(json.data)).to.eql(true);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "07 - Get Genres (GET /content/genres)",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/genres"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data exists', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.success).to.eql(true);",
              "  pm.expect(json).to.have.property('data');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "08 - Login (POST /auth/login) => store accessToken",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{loginEmail}}\",\n  \"password\": \"{{loginPassword}}\"\n}"
        },
        "url": "{{baseUrl}}/auth/login"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200 or 201', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});",
              "pm.test('Response contains accessToken', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('accessToken');",
              "  pm.expect(json.accessToken).to.be.a('string');",
              "  pm.environment.set('accessToken', json.accessToken);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "09 - Account Me (GET /accounts/me)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": "{{baseUrl}}/accounts/me"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('success=true and data has email', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.success).to.eql(true);",
              "  pm.expect(json.data).to.be.an('object');",
              "  pm.expect(json.data).to.have.property('email');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "10 - List Profiles (GET /profiles)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": "{{baseUrl}}/profiles"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Response is an array', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(Array.isArray(json)).to.eql(true);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "11 - Create Profile (POST /profiles) => store profileId",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"{{profileName}}\",\n  \"age\": 22,\n  \"language\": \"ENGLISH\"\n}"
        },
        "url": "{{baseUrl}}/profiles"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200 or 201', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});",
              "pm.test('Response has profileId', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('profileId');",
              "  pm.environment.set('profileId', String(json.profileId));",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "12 - Update Profile (PATCH /profiles/{{profileId}})",
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"{{profileNameUpdated}}\"\n}"
        },
        "url": "{{baseUrl}}/profiles/{{profileId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Name was updated', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('name', pm.environment.get('profileNameUpdated'));",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "13 - Set Profile Preferences (PUT /profiles/{{profileId}}/preferences)",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"items\": [\n    { \"genreId\": 1, \"classificationId\": 1 }\n  ]\n}"
        },
        "url": "{{baseUrl}}/profiles/{{profileId}}/preferences"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "14 - Create Invitation (POST /invitations) => store invitationCode",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"inviteeEmail\": \"{{inviteeEmail}}\"\n}"
        },
        "url": "{{baseUrl}}/invitations"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200 or 201', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});",
              "pm.test('Response contains invitationCode + emailSent', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('invitationCode');",
              "  pm.expect(json.invitationCode).to.be.a('string');",
              "  pm.expect(json).to.have.property('emailSent');",
              "  pm.environment.set('invitationCode', json.invitationCode);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "15 - Subscribe (POST /subscriptions/subscribe)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"quality\": \"HD\",\n  \"paymentMethod\": \"VISA\"\n}"
        },
        "url": "{{baseUrl}}/subscriptions/subscribe"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200 or 201', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});",
              "pm.test('Response contains message and subscription object', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "  pm.expect(json).to.have.property('subscription');",
              "  pm.expect(json.subscription).to.be.an('object');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "16 - Login invalid user (POST /auth/login) => 401",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"does.not.exist@example.com\",\n  \"password\": \"WrongPassword123\"\n}"
        },
        "url": "{{baseUrl}}/auth/login"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "17 - Account Me without token (GET /accounts/me) => 401",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/accounts/me"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "18 - Profiles without token (GET /profiles) => 401",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/profiles"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "19 - Profiles with invalid token (GET /profiles) => 401",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{invalidToken}}"
          }
        ],
        "url": "{{baseUrl}}/profiles"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "20 - Create Profile invalid body (POST /profiles) => 400",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"\"\n}"
        },
        "url": "{{baseUrl}}/profiles"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Validation response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "21 - Update Profile non-existing (PATCH /profiles/{{nonExistingId}}) => 404",
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Nope\"\n}"
        },
        "url": "{{baseUrl}}/profiles/{{nonExistingId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 404', function () {",
              "  pm.response.to.have.status(404);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "22 - Update Profile forbidden (PATCH /profiles/{{otherProfileId}}) => 403",
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Hacker Attempt\"\n}"
        },
        "url": "{{baseUrl}}/profiles/{{otherProfileId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 403', function () {",
              "  pm.response.to.have.status(403);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "23 - Content movies invalid minAge (GET /content/movies?minAge=abc) => 400",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/movies?minAge=abc"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "24 - Content movie not found (GET /content/movies/{{nonExistingId}}) => 404",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/movies/{{nonExistingId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 404', function () {",
              "  pm.response.to.have.status(404);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "25 - Content search missing q (GET /content/movies/search) => 400",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/movies/search"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "26 - Create Invitation invalid email (POST /invitations) => 400",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"inviteeEmail\": \"not-an-email\"\n}"
        },
        "url": "{{baseUrl}}/invitations"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Validation response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "27 - Subscribe invalid quality (POST /subscriptions/subscribe) => 400",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"quality\": \"INVALID\"\n}"
        },
        "url": "{{baseUrl}}/subscriptions/subscribe"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Validation response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "28 - Create movie without token (POST /content/movies) => 401",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Unauthorized Movie\",\n  \"description\": \"Should fail\",\n  \"genreId\": 1,\n  \"classificationId\": 1\n}"
        },
        "url": "{{baseUrl}}/content/movies"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "29 - Content series invalid minAge (GET /content/series?minAge=abc) => 400",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/series?minAge=abc"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "30 - Content series not found (GET /content/series/{{nonExistingId}}) => 404",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/series/{{nonExistingId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 404', function () {",
              "  pm.response.to.have.status(404);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "31 - Content episodes invalid season (GET /content/series/1/episodes?season=abc) => 400",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{baseUrl}}/content/series/1/episodes?season=abc"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "32 - Create Invitation without token (POST /invitations) => 401",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"inviteeEmail\": \"{{inviteeEmail}}\"\n}"
        },
        "url": "{{baseUrl}}/invitations"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "33 - Subscribe without token (POST /subscriptions/subscribe) => 401",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"quality\": \"HD\"\n}"
        },
        "url": "{{baseUrl}}/subscriptions/subscribe"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 401', function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "34 - Set Profile Preferences invalid body (PUT /profiles/{{profileId}}/preferences) => 400",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"items\": \"not-an-array\"\n}"
        },
        "url": "{{baseUrl}}/profiles/{{profileId}}/preferences"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 400', function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "pm.test('Validation response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "35 - Get Profile Preferences forbidden (GET /profiles/{{otherProfileId}}/preferences) => 403",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": "{{baseUrl}}/profiles/{{otherProfileId}}/preferences"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 403', function () {",
              "  pm.response.to.have.status(403);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "36 - Delete Profile (DELETE /profiles/{{profileId}}) => 200",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": "{{baseUrl}}/profiles/{{profileId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 200', function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "37 - Delete Profile again (DELETE /profiles/{{profileId}}) => 404",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{accessToken}}"
          }
        ],
        "url": "{{baseUrl}}/profiles/{{profileId}}"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Status code is 404', function () {",
              "  pm.response.to.have.status(404);",
              "});",
              "pm.test('Response has message', function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property('message');",
              "});"
            ]
          }
        }
      ]
    }
  ]
}
